time O(n) but O(log(n)) amortized
space O(1)