time O(nlogn + n)
space O(n)