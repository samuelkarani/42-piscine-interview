time O(n) except isBalance O(n^2)
space O(1)